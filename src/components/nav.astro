---
const rawBase = import.meta.env.BASE_URL || "/";
const base = rawBase.endsWith("/") ? rawBase : `${rawBase}/`;
const baseNoTrail = base.replace(/\/$/, "");

const LINKS = [
  { label: "Home", href: "/" },
  { label: "Launch", href: "/#launch" },
  { label: "Tokenomics", href: "/tokenomics" },
  { label: "Roadmap", href: "/roadmap" },
  { label: "FAQ", href: "/faq" },
  { label: "Links", href: "/links" },
  { label: "Verify", href: "/verify" },
  { label: "Checklist", href: "/checklist" },
];

// Normaliza rutas para GH Pages
function fixHref(href) {
  if (!href) return base;
  if (href.startsWith("#")) return href;
  if (href.startsWith("http")) return href;

  // asegura 1 slash al inicio
  const clean = href.startsWith("/") ? href.slice(1) : href;
  return `${base}${clean}`.replace(/\/{2,}/g, "/").replace(baseNoTrail + "/", base);
}

// Detectar si estamos “en home” bajo base
const path = Astro.url.pathname.replace(/\/$/, "");
const isHome = path === baseNoTrail || path === "";
---

<nav class="nav">
  <div class="container nav__inner">
    <a class="brand" href={fixHref("/")}>
      <span class="brand__dot"></span>
      <span class="brand__name">Capitoken</span>
    </a>

    <div class="nav__links">
      {LINKS.map((l) => (
        <a href={fixHref(l.href)} aria-current={isHome && l.href === "/" ? "page" : undefined}>
          {l.label}
        </a>
      ))}
    </div>
  </div>
</nav>
