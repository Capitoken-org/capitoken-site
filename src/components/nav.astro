---
const base = import.meta.env.BASE_URL; // "/" en dev, "/capitoken-site/" en build
const path = Astro.url.pathname;

// detecta home correctamente en dev y en build
const isHome =
  path === base ||
  path === base.replace(/\/$/, "") ||
  path === "/";

const LINKS = [
  { label: "Home", href: "/" },
  { label: "Launch", href: "#launch" },
  { label: "Tokenomics", href: "#tokenomics" },
  { label: "Roadmap", href: "#roadmap" },
  { label: "FAQ", href: "#faq" },
  { label: "Links", href: "/links" },
  { label: "Verify", href: "/verify" },
  { label: "Checklist", href: "/checklist" },
];

function fixHref(href) {
  // anchors: si no estÃ¡s en home, manda a /capitoken-site/#anchor
  if (href.startsWith("#")) return isHome ? href : `${base}${href}`;

  // externos
  if (href.startsWith("http")) return href;

  // internos absolutos "/links" => "/capitoken-site/links"
  if (href.startsWith("/")) return `${base}${href.slice(1)}`.replace(/\/{2,}/g, "/");

  // fallback
  return href;
}
---

<header class="nav">
  <div class="nav__inner">
    <a class="brand" href={base}>
      <span class="brand_dot"></span>
      <span class="brand_name">Capitoken</span>
    </a>

    <nav class="nav__links">
      {LINKS.map((l) => (
        <a href={fixHref(l.href)}>{l.label}</a>
      ))}
    </nav>
  </div>
</header>
