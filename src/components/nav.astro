---
/**
 * Nav component (NO <html>/<body> here).
 * Uses BASE_URL for GitHub Pages subpath safety.
 */
const BASE = import.meta.env.BASE_URL || "/";
const withBase = (p) => {
  const clean = String(p || "");
  return clean.startsWith("/") ? `${BASE}${clean.slice(1)}` : `${BASE}${clean}`;
};

const links = [
  { href: "#launchpanel", label: "Launch Panel" },
  { href: "#venues", label: "Markets" },
  { href: "#tokenomics", label: "Tokenomics" },
  { href: "#roadmap", label: "Roadmap" },
  { href: "#daily", label: "Daily" },
  { href: "#community", label: "Community" },
  { href: "#faq", label: "FAQ" },
  // /verify is a separate page (not a section on index)
  { href: withBase("/verify/"), label: "Verify", isPage: true },
];

// Social links (activate as you confirm official URLs)
const socials = [
  { key: "x", label: "X", href: "https://x.com/Capitokenorg" },
  { key: "telegram", label: "Telegram", href: null },
  { key: "discord", label: "Discord", href: null },
  { key: "reddit", label: "Reddit", href: null },
  { key: "youtube", label: "YouTube", href: "https://www.youtube.com/channel/UCY5xCVzo-k6hGdR4xhUhTNQ" },
  { key: "instagram", label: "Instagram", href: null },
  { key: "facebook", label: "Facebook", href: null },
];

const icon = (k) => {
  const label = ({
    x: "X",
    telegram: "TG",
    discord: "DS",
    reddit: "RD",
    youtube: "YT",
    instagram: "IG",
    facebook: "FB",
  })[k] || "?";

  return `<svg viewBox="0 0 24 24" aria-hidden="true">
    <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="1.5"/>
    <text x="12" y="16" text-anchor="middle" font-size="8.5" fill="currentColor" font-family="system-ui, sans-serif">${label}</text>
  </svg>`;
};
---

<header class="nav" role="banner">
  <div class="container nav__inner">
    <a class="brand" href={BASE} aria-label="Capitoken home">
      <img
        class="brand__img"
        src={withBase("/brand/logo-navbar.png")}
        alt="Capitoken"
        loading="eager"
        decoding="async"
      />
      <span class="sr-only">Capitoken</span>
    </a>

    <nav class="nav__links" aria-label="Primary navigation">
      {links.map((l) => (
        <a href={l.href}>{l.label}</a>
      ))}
    </nav>
  </div>

  <!-- Secondary row: socials + live ticker -->
  <div class="container nav__sub" aria-label="Live ticker and socials">
    <div class="nav__social" aria-label="Official socials">
      {socials.map((s) => (
        s.href ? (
          <a class="social-ico" href={s.href} target="_blank" rel="noopener noreferrer" aria-label={s.label} set:html={icon(s.key)} />
        ) : (
          <span class="social-ico is-disabled" aria-label={`${s.label} (coming soon)`} set:html={icon(s.key)} />
        )
      ))}
    </div>

    <div class="nav__ticker" aria-label="Market ticker">
      <span class="live-pill">LIVE</span>
      <div id="ticker" class="ticker" aria-live="polite">Loading prices...</div>
      <div id="ticker-clock" class="ticker-clock" aria-label="Local time"></div>
    </div>
  </div>
</header>
